<IfModule mod_proxy.c>

    #here we can test http <-> https
    <VirtualHost proxyssl>
        #these are not on by default in the 1.x based mod_ssl
        <IfDefine APACHE2>
            SSLProxyEngine On

            SSLProxyProtocol +SSLv2 +SSLv3 +TLSv1
            SSLProxyCipherSuite ALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL

            SSLProxyMachineCertificateFile @SSLCA@/asf/proxy/client_ok.pem
            #SSLProxyMachineCertificatePath @SSLCA@/asf/proxy

            SSLProxyCACertificateFile @SSLCA@/asf/certs/ca.crt
            SSLProxyCACertificatePath @ServerRoot@/conf/ssl
            SSLProxyCARevocationFile @SSLCA@/asf/crl/ca-bundle.crl
            SSLProxyVerify on
            SSLProxyVerifyDepth 10
        </IfDefine>


        ProxyPass        / https://@proxyssl_url@/
        ProxyPassReverse / https://@proxyssl_url@/
    </VirtualHost>


    #here we can test https <-> https
    <VirtualHost proxyssl_ssl>
        SSLEngine on

        #these are not on by default in the 1.x based mod_ssl
        <IfDefine APACHE2>
            SSLProxyEngine On
            #SSLProxyMachineCertificateFile @SSLCA@/asf/proxy/client_ok.pem
            #client_ok.pem should be loaded first
            SSLProxyMachineCertificatePath @SSLCA@/asf/proxy
            SSLProxyCACertificateFile @SSLCA@/asf/certs/ca.crt
            SSLProxyVerify on
            SSLProxyCARevocationPath @SSLCA@/asf/crl
        </IfDefine>


        ProxyPass        / https://@proxyssl_url@/
        ProxyPassReverse / https://@proxyssl_url@/
    </VirtualHost>

</IfModule>
